<idea-plugin xmlns:xi="http://www.w3.org/1999/XSL/Transform">
    <id>org.reloadium</id>
    <name>Reloadium - ChatGPT, Hot Reloading and Profiling for Python</name>
    <version>1.2.0</version>
    <idea-version since-build="223"/>
    <vendor email="damian@reloadware.com" url="reloadium.io">Reloadware</vendor>
    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.python</depends>
    <depends>com.intellij.modules.platform</depends>

    <description><![CDATA[
        <h3>ChatGPT integration</h3>
        <div>
            <img src="https://raw.githubusercontent.com/reloadware/reloadium/main/media/chatgpt_fix.gif" width="600px" alt="ChatGPT"/>
        </div>

        <h3>Hot reloading:</h3>
        <div>
            <img src="https://raw.githubusercontent.com/reloadware/reloadium/main/media/example_small.gif" width="600px" alt="Hot Reloading"/>
        </div>

        <h3>Profiling</h3>
        <div>
            <img src="https://raw.githubusercontent.com/reloadware/reloadium/main/media/profiling.gif" width="600px" alt="Profiling"/>
        </div>

        
         <p>Reloadium adds hot reloading, profiling and ChatGPT chat to your IDE</p>
        ]]>
    </description>

    <extensions defaultExtensionNs="com.intellij">
        <errorHandler implementation="rw.audit.ErrorSubmitter"/>

        <fileEditorProvider implementation="rw.ai.chat.ChatProvider"/>

        <projectConfigurable
                parentId="tools"
                instance="rw.settings.ProjectSettingsConfigurable"
                id="rw.settings.ProjectSettings"
                displayName="Reloadium Project Settings"
                nonDefaultProject="false"/>

        <projectService
                serviceImplementation="rw.settings.ProjectSettings"/>

        <applicationConfigurable
                parentId="tools"
                instance="rw.preferences.PreferencesConfigurable"
                id="rw.preferences.Preferences"
                displayName="Reloadium Preferences"/>

        <applicationConfigurable
                parentId="tools"
                instance="rw.ai.preferences.AiPreferencesConfigurable"
                id="rw.ai.preferences.AiPreferences"
                displayName="Reloadium Preferences"/>

        <applicationService
                serviceImplementation="rw.preferences.Preferences"/>
        <applicationService
                serviceImplementation="rw.ai.preferences.AiPreferences"/>

        <applicationService
                serviceImplementation="rw.dialogs.DialogsState"
        />

        <applicationService
                serviceInterface="rw.service.Service"
                serviceImplementation="rw.service.Service"
        />


        <postStartupActivity implementation="rw.service.Startup"/>
        <postStartupActivity implementation="rw.ai.Startup"/>

        <fileDocumentManagerListener implementation="rw.action.ReloadOnSave"/>
        <fileIconPatcher implementation="rw.icons.IconPatcher" order="last"/>
        <projectViewNodeDecorator implementation="rw.icons.IconDecorator"/>

        <completion.contributor language="Python"
                                implementationClass="rw.completion.LocalCompletionContributor"/>
        <completion.contributor language="Python"
                                implementationClass="rw.completion.GlobalCompletionContributor"/>
        <completion.contributor language="Python"
                                implementationClass="rw.completion.ImportCompletionContributor"/>
        <completion.contributor language="Python"
                                implementationClass="rw.completion.FrameCompletionContributor"/>
        <completion.contributor language="Python"
                                implementationClass="rw.completion.FromImportCompletionContributor"/>
        <codeInsight.lineMarkerProvider language="Python"
                                        implementationClass="rw.completion.CompletableFunctionsLineMarker"/>
        <notificationGroup id="reloadium" displayType="BALLOON"/>
    </extensions>

    <actions>
        <action id="FastDebugWithReloadium"
                class="rw.action.FastDebugWithReloadium"
                text="Fast Debug with Reloadium"
                description="Fast Debug script with hot reloading enabled"
                icon="rw.icons.Icons.FastDebug"
        >
            <add-to-group group-id="ToolbarRunGroup" anchor="first"/>
            <add-to-group group-id="RunToolbarMainActionGroup" anchor="first"/>
            <add-to-group group-id="RunMenu" anchor="first"/>
            <add-to-group group-id="RunDashboardContentToolbar" anchor="first"/>
        </action>
        <action id="NewChatAction"
                class="rw.ai.actions.NewChatAction"
                text="New AI Chat"
                description="Fast Debug script with hot reloading enabled"
                icon="rw.icons.Icons.FastDebug"
        >
            <add-to-group group-id="ToolbarRunGroup" anchor="first"/>
            <add-to-group group-id="RunToolbarMainActionGroup" anchor="first"/>
            <add-to-group group-id="RunMenu" anchor="first"/>
            <add-to-group group-id="RunDashboardContentToolbar" anchor="first"/>
        </action>

        <action id="DebugWithReloadium"
                class="rw.action.DebugWithReloadium"
                text="Debug with Reloadium"
                description="Debug script with hot reloading enabled"
                icon="rw.icons.Icons.Debug"
        >
            <add-to-group group-id="ToolbarRunGroup" anchor="first"/>
            <add-to-group group-id="RunToolbarMainActionGroup" anchor="first"/>
            <add-to-group group-id="RunMenu" anchor="first"/>
            <add-to-group group-id="RunDashboardContentToolbar" anchor="first"/>
        </action>

        <action id="RunWithReloadium"
                class="rw.action.RunWithReloadium"
                text="Run with Reloadium"
                description="Run script with hot reloading enabled"
                icon="rw.icons.Icons.Run">
            <add-to-group group-id="ToolbarRunGroup" anchor="first"/>
            <add-to-group group-id="RunToolbarMainActionGroup" anchor="first"/>
            <add-to-group group-id="RunMenu" anchor="first"/>
            <add-to-group group-id="RunDashboardContentToolbar" anchor="first"/>
        </action>

        <action id="FastDebugWithReloadiumRunContextPopup"
                class="rw.action.FastDebugWithReloadiumRunContext"
                text="Fast Debug with Reloadium"
                description="Fast Debug script with hot reloading enabled"
                icon="rw.icons.Icons.FastDebug">
            <add-to-group group-id="RunContextGroup" anchor="first"/>
        </action>

        <action id="DebugWithReloadiumRunContext"
                class="rw.action.DebugWithReloadiumRunContext"
                text="Debug with Reloadium"
                description="Debug script with hot reloading enabled"
                icon="rw.icons.Icons.Debug">
            <add-to-group group-id="RunContextGroup" anchor="first"/>
        </action>

        <action id="RunWithReloadiumRunContext"
                class="rw.action.RunWithReloadiumRunContext"
                text="Run with Reloadium"
                description="Run script with hot reloading enabled"
                icon="rw.icons.Icons.Run">
            <add-to-group group-id="RunContextGroup" anchor="first"/>
        </action>

        <action id="ManualReload"
                class="rw.action.ManualReload"
                text="Hot Reload File"
                description="Hot Reload File"
                icon="rw.icons.Icons.Update">
            <add-to-group group-id="ToolbarRunGroup" anchor="first"/>
            <add-to-group group-id="RunContextGroup" anchor="last"/>
        </action>

        <action id="RerunDebugWithReloadium" class="rw.action.RerunDebugWithReloadium">
            <add-to-group group-id="XDebugger.ToolWindow.LeftToolbar" anchor="first"/>
        </action>

        <group id="ReloadiumGroup" text="Reloadium" popup="true">
            <action id="ReloadiumProjectSettings"
                    class="rw.action.ProjectSettings"
                    text="Project Settings"
                    icon="rw.icons.Icons.Settings">
            </action>
            <action id="ReloadiumPreferences"
                    class="rw.action.Preferences"
                    text="Preferences"
                    icon="rw.icons.Icons.Settings">
            </action>
            <action id="ReloadiumAbout"
                    class="rw.action.About"
                    text="About"
                    icon="rw.icons.Icons.About">
            </action>
            <add-to-group group-id="MainMenu" relative-to-action="ToolsMenu" anchor="before"/>
        </group>

        <action id="Profile" class="rw.profile.ProfileResultToggle" icon="rw.icons.Icons.Timing">
            <add-to-group group-id="EditorGutterVcsPopupMenu" relative-to-action="Annotate" anchor="after"/>
        </action>

        <action id="DropFrame"
                class="rw.action.DropFrameAction"
                text="Reset Frame"
                icon="rw.icons.Icons.DropFrame">
            <add-to-group group-id="DebuggingActionsGroup"/>
            <add-to-group group-id="XDebugger.Frames.Tree.Popup" anchor="first"/>
            <add-to-group group-id="XDebugger.ToolWindow.TopToolbar3.Extra"/>
        </action>
    </actions>

    <xi:include href="ai.xml"/>
    <xi:include href="depot.xml"/>
</idea-plugin>